@{
    ViewBag.Title = "Widget Load Statistics";
}

<!-- Main bar -->
<div class="mainbar">
    <!-- Matter -->
    <div class="matter">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div id="objectTable" class="widget wblue">
                        <div class="widget-head">
                            <div class="pull-left">
                                <h1>@ViewBag.Title</h1>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="widget-content">
                            <div class="row ">
                                <div class=" col-md-12">
                                    <div class="session-history-search">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="col-md-2 control-label">Dates: </label>
                                                <div class="col-md-10">
                                                    <input id="reportrange" class="date-input form-control"
                                                           data-bind="daterangepicker: dateRange, daterangepickerOptions: dateRangeOptions" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <button name="searchbtn" data-bind="click: startSearch" class="btn btn-primary ">Search</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12" style="display: none;" data-bind="visible: errorModel.errorMessages().length > 0">
                                <div class="padd statement alert-danger" data-bind="foreach: errorModel.errorMessages">
                                    <p class="" data-bind="text: $data"></p>
                                </div>
                            </div>

                            <div class="row sesion-history-area">
                                <div class="col-md-12">
                                    <table class="table table-striped table-hover hidden-sm hidden-xs" data-bind="visible: records().length > 0">
                                        <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Page loads</th>
                                            <th>Overload</th>
                                        </tr>
                                        </thead>
                                        <tbody data-bind="foreach: records">
                                        <tr>
                                            <td data-bind="html: Dt.asUtcDateHtml(Date)"></td>
                                            <td data-bind="text: Count"></td>
                                            <td data-bind="text: Overload"></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts_include {
}

@section scripts{
    <script type="text/javascript">
        
        var customerId = @UserIdentity.GetCustomerId(User.Identity);
        var currentUserId = @UserIdentity.GetUserId(User.Identity);

        require(
            ['pages/WidgetLoadStatistics', 'Dt', 'bindings/daterangepicker'],
            function (app, dt)
            {
                window.Dt = dt.default;

                $(
                    function ()
                    {
                        new app.default(customerId, currentUserId).run();
                    });
            });

        var width = '150px';
        $("#selectAgentSelect").multiselect(
            {
                buttonWidth: width
            });
        $("#selectOperationsSelect").multiselect(
            {
                buttonWidth: width
            });
        $("#selectStatusSelect").multiselect(
            {
                buttonWidth: width
            });
    </script>
}